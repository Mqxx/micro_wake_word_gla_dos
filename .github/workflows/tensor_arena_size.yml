name: Berechne Tensor Arena Size

on:
  push:
    paths:
      - '**/*.tflite'   # Auslösen bei Änderungen an .tflite-Dateien
  workflow_dispatch:     # Manuellen Trigger ermöglichen

jobs:
  find-arena-size:
    runs-on: ubuntu-latest

    steps:
      - name: Checke Code aus
        uses: actions/checkout@v4

      - name: Installiere abhängigkeiten
        run: npm install tflite-find-arena-size

      - name: Finde .tflite-Modelle
        id: models
        run: |
          echo "LIST<<EOF" > models.txt
          find . -type f -name "*.tflite" >> models.txt
          echo "EOF" >> models.txt
          cat models.txt

      - name: Berechne arena size für jedes Modell
        run: |
          models=$(find . -type f -name "*.tflite")
          if [ -z "$models" ]; then
            echo "Kein tflite-Modell gefunden."
            exit 1
          fi
          node compute_arena.js $models
